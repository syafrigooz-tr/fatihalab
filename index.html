<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Abang Fatih vs Abang Alab</title>
<style>
  body { font-family: Arial; text-align:center; margin:0; padding:20px; background:#f0f0f0; }
  canvas { border:2px solid #333; background:white; }
  #gameOverScreen {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(255,255,255,0.95);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 28px;
    font-weight: bold;
  }
  #gameOverScreen img {
    width: 120px;
    margin: 10px 0;
  }
  #restartBtn {
    margin-top: 15px;
    padding: 10px 20px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    background: #28a745;
    color: white;
    cursor: pointer;
  }
</style>
</head>
<body>
<h1>Game Abang Fatih vs Abang Alab</h1>
<canvas id="gameCanvas" width="800" height="300"></canvas>

<div id="gameOverScreen">
  <div id="winnerText">WINNER</div>
  <img id="winnerImg" src="" alt="Pemenang">
  <div id="finalScore"></div>
  <button id="restartBtn">Main Lagi!</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let player1 = { x: 50, y: 200, width: 40, height: 40, color: "blue", dy: 0, jumping: false, score: 0, img: "Gambar1.png" };
let player2 = { x: 50, y: 250, width: 40, height: 40, color: "green", dy: 0, jumping: false, score: 0, img: "Gambar2.png" };

let gravity = 0.6;
let obstacles = [];
let frame = 0;
let gameOver = false;

// muat gambar sawit
let sawit = new Image();
sawit.src = "sawit.png"; // ganti dengan file gambar sawit
let sawitWidth = 40;  // diperkecil
let sawitHeight = 60; // diperkecil

function drawPlayer(player) {
  let img = new Image();
  img.src = player.img;
  ctx.drawImage(img, player.x, player.y, player.width, player.height);
}

function drawObstacle(obs) {
  ctx.drawImage(sawit, obs.x, obs.y, obs.width, obs.height);
}

function updatePlayer(player, ground) {
  player.y += player.dy;
  if (player.y + player.height < ground) {
    player.dy += gravity;
  } else {
    player.y = ground - player.height;
    player.dy = 0;
    player.jumping = false;
  }
}

function detectCollision(player, obs) {
  return (
    player.x < obs.x + obs.width &&
    player.x + player.width > obs.x &&
    player.y < obs.y + obs.height &&
    player.y + player.height > obs.y
  );
}

function gameLoop() {
  if (gameOver) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  updatePlayer(player1, 240);
  updatePlayer(player2, 290);

  drawPlayer(player1);
  drawPlayer(player2);

  if (frame % 90 === 0) {
    obstacles.push({
      x: canvas.width,
      y: 240 - sawitHeight,
      width: sawitWidth,
      height: sawitHeight
    });
  }

  obstacles.forEach((obs, index) => {
    obs.x -= 5;
    drawObstacle(obs);

    if (detectCollision(player1, obs)) {
      endGame("Abang Alab", player2);
    }
    if (detectCollision(player2, obs)) {
      endGame("Abang Fatih", player1);
    }

    if (obs.x + obs.width < 0) {
      obstacles.splice(index, 1);
      player1.score++;
      player2.score++;
    }
  });

  ctx.fillText("Skor Fatih: " + player1.score, 10, 20);
  ctx.fillText("Skor Alab: " + player2.score, 10, 40);

  frame++;
  requestAnimationFrame(gameLoop);
}

function endGame(winner, winnerPlayer) {
  gameOver = true;
  document.getElementById("gameOverScreen").style.display = "flex";
  document.getElementById("winnerText").textContent = "WINNER: " + winner;
  document.getElementById("winnerImg").src = winnerPlayer.img;
  document.getElementById("finalScore").textContent = "Skor: " + winnerPlayer.score;
}

document.addEventListener("keydown", (e) => {
  if (e.code === "KeyW" && !player1.jumping) {
    player1.dy = -10; player1.jumping = true;
  }
  if (e.code === "ArrowUp" && !player2.jumping) {
    player2.dy = -10; player2.jumping = true;
  }
});

document.getElementById("restartBtn").addEventListener("click", () => {
  location.reload();
});

gameLoop();
</script>
</body>
</html>
